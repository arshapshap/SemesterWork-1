<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="~/css/common.css">
    <link rel="stylesheet" href="~/css/publication.css">
    <title>{{ publication.musician.name }} - {{ publication.title }} (Аккорды)</title>
</head>

<body class="body">
    <div class="container">
        <div class="header-left">
            <a href="/main">
                <img class="profile-image" src="~/img/home.png">
            </a>
        </div>
        *HEADER*
        <div class="publication">
            <div class="publication-header">
                <img class="publication-image"
                    src="{{ publication.musician.image }}">
                <div class="publication-info">
                    <div class="publication-title">
                        <a href="/musician/{{ publication.musician.id }}" class="musician link">{{ publication.musician.name }}</a> - {{ publication.title }}
                    </div>
                    <div class="publication-author">
                        <a href="/profile/{{ publication.author.id }}" class="link">{{ publication.author.name }}</a>, {{ publication.date }}
                    </div>

                </div>
                <div class="publication-ratings">
                    <div class="publication-rating">
                        <span>{{ publication.rating }}</span>
                        <img src="~/img/star.png">
                    </div>
                </div>
            </div>

            <pre class="chords">
                {{ publication.text }}
            </pre>
        </div>

        {{ if current_user && (current_user.id == publication.author.id) }}
        <a href="/publication/delete/{{publication.id}}" class="div-title link"><br>Удалить публикацию</a>
        {{ end }}

        {{ if current_user }}
        <div class="rate">
            <div class="new-comment">
                <div class="div-title">Оставьте комментарий:</div>
                <form name="new-comment" method="POST" action="comment">
                    <input class="field-input" name="comment" type="text"></input>
                    <button class="button" type="submit">Отправить</button>
                </form>
            </div>
            {{ if current_user.id != publication.author.id }}
            <div class="new-rating">
                <div class="div-title">Оцените публикацию:</div>
                <form name="new-rating" method="POST" action="rating">
                    <input name="rating" id="rating-1" type="radio" value="1">
                    <label for="rating-1">1</label>
                    <input name="rating" id="rating-2" type="radio" value="2">
                    <label for="rating-2">2</label>
                    <input name="rating" id="rating-3" type="radio" value="3">
                    <label for="rating-3">3</label>
                    <input name="rating" id="rating-4" type="radio" value="4">
                    <label for="rating-4">4</label>
                    <input name="rating" id="rating-5" type="radio" value="5">
                    <label for="rating-5">5</label>
                    <button class="button" type="submit">Отправить</button>
                </form>
            </div>
            {{ end }}
        </div>
        {{ end }}

        <div class="comments">
            {{ if publication.comments.size > 0 }}
            <div class="div-title">Комментарии:</div>
            {{ for comment in publication.comments }}
            <div class="publication comment">
                <img class="profile-image comment-author-image"
                    src="https://bugaga.ru/uploads/posts/2017-03/1489052030_kotik-hosiko-12.jpg" alt="">
                <div class="publication-info">
                    <div class="comment-body">
                        <a href="author" class="publication-author link">Артём Шаповалов</a>, 11:36 21.11.2022
                        <br>Аоаоо
                    </div>
                </div>
            </div>
            {{ end }}
            {{ else }}
            <div class="div-title">Комментариев нет.</div>
            {{ end }}
        </div>
    </div>
</body>

</html>